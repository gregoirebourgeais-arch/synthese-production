<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Synthèse Production Lactalis</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
  <!-- 🧮 Calculatrice flottante -->
<div id="calculator" class="calculator hidden">
  <div class="calc-header">
    <span>Calculatrice</span>
    <button id="closeCalc">✖</button>
  </div>
  <input type="text" id="calcDisplay" readonly />

  <div class="calc-buttons">
    <button class="calc-btn">7</button>
    <button class="calc-btn">8</button>
    <button class="calc-btn">9</button>
    <button class="calc-btn op">/</button>

    <button class="calc-btn">4</button>
    <button class="calc-btn">5</button>
    <button class="calc-btn">6</button>
    <button class="calc-btn op">*</button>

    <button class="calc-btn">1</button>
    <button class="calc-btn">2</button>
    <button class="calc-btn">3</button>
    <button class="calc-btn op">-</button>

    <button class="calc-btn">0</button>
    <button class="calc-btn">.</button>
    <button id="calcEqual">=</button>
    <button class="calc-btn op">+</button>
  </div>
</div>

<!-- Bouton flottant pour ouvrir la calculatrice -->
<button id="openCalc" class="floating-btn">🧮</button>

<body>
  <header>
    <img src="logo.png" alt="Logo Lactalis" class="logo">
    <h1>Synthèse Production Lactalis</h1>
    <p id="dateHeure"></p>
    <p id="equipeActuelle"></p>
  </header>

  <nav class="navbar">
    <button onclick="showSection('atelier')">🏭 Atelier</button>
    <button onclick="showSection('arrets')">⏸️ Arrêts</button>
    <button onclick="showSection('personnel')">👥 Personnel</button>
    <button onclick="showSection('organisation')">🗒️ Organisation</button>
    <button onclick="exportGlobal()">📊 Export</button>
  </nav>

  <!-- Atelier -->
  <section id="atelier" class="page active">
    <h2>Atelier</h2>
    <div class="lignes-container">
      <button onclick="selectLine('Râpé')">Râpé</button>
      <button onclick="selectLine('T2')">T2</button>
      <button onclick="selectLine('RT')">RT</button>
      <button onclick="selectLine('OMORI')">OMORI</button>
      <button onclick="selectLine('T1')">T1</button>
      <button onclick="selectLine('Sticks')">Sticks</button>
      <button onclick="selectLine('Emballage')">Emballage</button>
      <button onclick="selectLine('Dés')">Dés</button>
      <button onclick="selectLine('Filets')">Filets</button>
      <button onclick="selectLine('Prédécoupé')">Prédécoupé</button>
    </div>

    <h3 id="ligneTitre">Ligne : —</h3>

    <label>Heure début :</label>
    <input type="time" id="heureDebut">
    <label>Heure fin :</label>
    <input type="time" id="heureFin">

    <label>Quantité réalisée :</label>
    <input type="number" id="qteRealisee" placeholder="colis">

    <label>Quantité restante :</label>
    <input type="number" id="qteRestante" placeholder="colis" oninput="updateEstimation()">

    <label>Cadence manuelle (colis/h) :</label>
    <input type="number" id="cadenceManuelle" placeholder="optionnel">

    <label>Cadence calculée :</label>
    <input type="text" id="cadenceCalculee" readonly>

    <label>Estimation de fin :</label>
    <input type="text" id="estimationFin" readonly>

    <div class="boutons">
      <button class="enregistrer" onclick="enregistrer()">💾 Enregistrer</button>
      <button class="reset" onclick="resetForm()">🧹 Remise à zéro</button>
    </div>

    <h3>Historique production</h3>
    <div id="historique"></div>

    <h3>Graphique des quantités réalisées</h3>
    <canvas id="chartQuantites"></canvas>
  </section>

  <!-- Arrêts -->
  <section id="arrets" class="page">
    <h2>Arrêts</h2>
    <label>Ligne :</label>
    <select id="arretLigne">
      <option value="">Sélectionner une ligne</option>
      <option>Râpé</option><option>T2</option><option>RT</option>
      <option>OMORI</option><option>T1</option><option>Sticks</option>
      <option>Emballage</option><option>Dés</option><option>Filets</option>
      <option>Prédécoupé</option>
    </select>
    <label>Durée de l’arrêt (minutes) :</label>
    <input type="number" id="dureeArret" placeholder="minutes">
    <label>Motif :</label>
    <input type="text" id="motifArret">
    <button onclick="enregistrerArret()">💾 Enregistrer</button>
    <div id="historiqueArrets"></div>
  </section>

  <!-- Personnel -->
  <section id="personnel" class="page">
    <h2>Personnel</h2>
    <label>Nom :</label><input id="nomPers">
    <label>Motif :</label><input id="motifPers">
    <label>Commentaire :</label><input id="comPers">
    <button onclick="enregistrerPersonnel()">💾 Enregistrer</button>
    <div id="historiquePersonnel"></div>
  </section>

  <!-- Organisation -->
  <section id="organisation" class="page">
    <h2>Organisation</h2>
    <textarea id="noteOrganisation" placeholder="Écrire une consigne..."></textarea>
    <button onclick="enregistrerOrganisation()">💾 Enregistrer</button>
    <div id="historiqueOrganisation"></div>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) navigator.serviceWorker.register('service-worker.js');
  </script>
</body>
</html>
