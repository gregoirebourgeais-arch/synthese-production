<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SynthÃ¨se Atelier Lactalis</title>
  <link rel="stylesheet" href="style.css"/>
  <!-- Chart.js + XLSX -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <header>
    <h1>SynthÃ¨se Atelier Lactalis</h1>
    <div id="horloge"></div>
  </header>

  <nav id="menu">
    <button onclick="showPage('atelier')">ğŸ­ Atelier</button>
    <button onclick="showPage('production')">ğŸ“¦ Production</button>
    <button onclick="showPage('arrets')">â± ArrÃªts</button>
    <button onclick="showPage('organisation')">ğŸ“ Organisation</button>
    <button onclick="showPage('personnel')">ğŸ‘¥ Personnel</button>
  </nav>

  <main>
    <!-- ===== ATELIER ===== -->
    <section id="atelier" class="page-section active">
      <h2>Vue Atelier</h2>
      <canvas id="chartQuantites" height="140"></canvas>
      <div class="card">
        <h3>ArrÃªts (classement par durÃ©e)</h3>
        <div id="atelierArrets"></div>
      </div>
      <button class="export-btn" onclick="exportAll()">ğŸ“Š Export Excel global</button>
    </section>

    <!-- ===== PRODUCTION ===== -->
    <section id="production" class="page-section">
      <h2>Production par ligne</h2>
      <div class="ligne-buttons">
        <button onclick="showLine('RÃ¢pÃ©')">RÃ¢pÃ©</button>
        <button onclick="showLine('T2')">T2</button>
        <button onclick="showLine('RT')">RT</button>
        <button onclick="showLine('OMORI')">OMORI</button>
        <button onclick="showLine('T1')">T1</button>
        <button onclick="showLine('Sticks')">Sticks</button>
        <button onclick="showLine('Emballage')">Emballage</button>
        <button onclick="showLine('DÃ©s')">DÃ©s</button>
        <button onclick="showLine('Filets')">Filets</button>
        <button onclick="showLine('PrÃ©dÃ©coupÃ©')">PrÃ©dÃ©coupÃ©</button>
      </div>

      <!-- 10 FORMULAIRES (un par ligne) -->
      <div id="Lignes">

        <!-- === RÃ¢pÃ© === -->
        <section id="line-RÃ¢pÃ©" class="line-card hidden">
          <h3>RÃ¢pÃ©</h3>
          <form onsubmit="saveProd(event,'RÃ¢pÃ©')">
            <label>Heure dÃ©but</label><input type="time" id="debut-RÃ¢pÃ©" required>
            <label>Heure fin</label><input type="time" id="fin-RÃ¢pÃ©" required>
            <label>QuantitÃ© rÃ©alisÃ©e</label><input type="number" id="qte-RÃ¢pÃ©" placeholder="colis">
            <label>QuantitÃ© restante</label><input type="number" id="reste-RÃ¢pÃ©" placeholder="colis" oninput="liveEstimate('RÃ¢pÃ©')">
            <label>Cadence manuelle (colis/h)</label><input type="number" id="cadenceManuelle-RÃ¢pÃ©" placeholder="optionnel">

            <div class="stats">
              <p>Cadence calculÃ©e : <b id="cad-RÃ¢pÃ©">0</b> c/h</p>
              <p>Fin estimÃ©e : <b id="finEst-RÃ¢pÃ©">â€”</b></p>
            </div>

            <div class="row">
              <button type="submit">ğŸ’¾ Enregistrer</button>
              <button type="button" onclick="resetLine('RÃ¢pÃ©')">ğŸ”„ Remise Ã  zÃ©ro</button>
            </div>
          </form>

          <div class="card">
            <h4>Historique</h4>
            <div id="hist-RÃ¢pÃ©"></div>
          </div>
          <canvas id="graph-RÃ¢pÃ©" height="120"></canvas>
        </section>

        <!-- === T2 === -->
        <section id="line-T2" class="line-card hidden">
          <h3>T2</h3>
          <form onsubmit="saveProd(event,'T2')">
            <label>Heure dÃ©but</label><input type="time" id="debut-T2" required>
            <label>Heure fin</label><input type="time" id="fin-T2" required>
            <label>QuantitÃ© rÃ©alisÃ©e</label><input type="number" id="qte-T2" placeholder="colis">
            <label>QuantitÃ© restante</label><input type="number" id="reste-T2" placeholder="colis" oninput="liveEstimate('T2')">
            <label>Cadence manuelle (colis/h)</label><input type="number" id="cadenceManuelle-T2" placeholder="optionnel">
            <div class="stats">
              <p>Cadence calculÃ©e : <b id="cad-T2">0</b> c/h</p>
              <p>Fin estimÃ©e : <b id="finEst-T2">â€”</b></p>
            </div>
            <div class="row">
              <button type="submit">ğŸ’¾ Enregistrer</button>
              <button type="button" onclick="resetLine('T2')">ğŸ”„ Remise Ã  zÃ©ro</button>
            </div>
          </form>
          <div class="card"><h4>Historique</h4><div id="hist-T2"></div></div>
          <canvas id="graph-T2" height="120"></canvas>
        </section>

        <!-- === RT === -->
        <section id="line-RT" class="line-card hidden">
          <h3>RT</h3>
          <form onsubmit="saveProd(event,'RT')">
            <label>Heure dÃ©but</label><input type="time" id="debut-RT" required>
            <label>Heure fin</label><input type="time" id="fin-RT" required>
            <label>QuantitÃ© rÃ©alisÃ©e</label><input type="number" id="qte-RT" placeholder="colis">
            <label>QuantitÃ© restante</label><input type="number" id="reste-RT" placeholder="colis" oninput="liveEstimate('RT')">
            <label>Cadence manuelle (colis/h)</label><input type="number" id="cadenceManuelle-RT" placeholder="optionnel">
            <div class="stats">
              <p>Cadence calculÃ©e : <b id="cad-RT">0</b> c/h</p>
              <p>Fin estimÃ©e : <b id="finEst-RT">â€”</b></p>
            </div>
            <div class="row">
              <button type="submit">ğŸ’¾ Enregistrer</button>
              <button type="button" onclick="resetLine('RT')">ğŸ”„ Remise Ã  zÃ©ro</button>
            </div>
          </form>
          <div class="card"><h4>Historique</h4><div id="hist-RT"></div></div>
          <canvas id="graph-RT" height="120"></canvas>
        </section>

        <!-- === OMORI === -->
        <section id="line-OMORI" class="line-card hidden">
          <h3>OMORI</h3>
          <form onsubmit="saveProd(event,'OMORI')">
            <label>Heure dÃ©but</label><input type="time" id="debut-OMORI" required>
            <label>Heure fin</label><input type="time" id="fin-OMORI" required>
            <label>QuantitÃ© rÃ©alisÃ©e</label><input type="number" id="qte-OMORI" placeholder="colis">
            <label>QuantitÃ© restante</label><input type="number" id="reste-OMORI" placeholder="colis" oninput="liveEstimate('OMORI')">
            <label>Cadence manuelle (colis/h)</label><input type="number" id="cadenceManuelle-OMORI" placeholder="optionnel">
            <div class="stats">
              <p>Cadence calculÃ©e : <b id="cad-OMORI">0</b> c/h</p>
              <p>Fin estimÃ©e : <b id="finEst-OMORI">â€”</b></p>
            </div>
            <div class="row">
              <button type="submit">ğŸ’¾ Enregistrer</button>
              <button type="button" onclick="resetLine('OMORI')">ğŸ”„ Remise Ã  zÃ©ro</button>
            </div>
          </form>
          <div class="card"><h4>Historique</h4><div id="hist-OMORI"></div></div>
          <canvas id="graph-OMORI" height="120"></canvas>
        </section>

        <!-- === T1 === -->
        <section id="line-T1" class="line-card hidden">
          <h3>T1</h3>
          <form onsubmit="saveProd(event,'T1')">
            <label>Heure dÃ©but</label><input type="time" id="debut-T1" required>
            <label>Heure fin</label><input type="time" id="fin-T1" required>
            <label>QuantitÃ© rÃ©alisÃ©e</label><input type="number" id="qte-T1" placeholder="colis">
            <label>QuantitÃ© restante</label><input type="number" id="reste-T1" placeholder="colis" oninput="liveEstimate('T1')">
            <label>Cadence manuelle (colis/h)</label><input type="number" id="cadenceManuelle-T1" placeholder="optionnel">
            <div class="stats">
              <p>Cadence calculÃ©e : <b id="cad-T1">0</b> c/h</p>
              <p>Fin estimÃ©e : <b id="finEst-T1">â€”</b></p>
            </div>
            <div class="row">
              <button type="submit">ğŸ’¾ Enregistrer</button>
              <button type="button" onclick="resetLine('T1')">ğŸ”„ Remise Ã  zÃ©ro</button>
            </div>
          </form>
          <div class="card"><h4>Historique</h4><div id="hist-T1"></div></div>
          <canvas id="graph-T1" height="120"></canvas>
        </section>

        <!-- === Sticks === -->
        <section id="line-Sticks" class="line-card hidden">
          <h3>Sticks</h3>
          <form onsubmit="saveProd(event,'Sticks')">
            <label>Heure dÃ©but</label><input type="time" id="debut-Sticks" required>
            <label>Heure fin</label><input type="time" id="fin-Sticks" required>
            <label>QuantitÃ© rÃ©alisÃ©e</label><input type="number" id="qte-Sticks" placeholder="colis">
            <label>QuantitÃ© restante</label><input type="number" id="reste-Sticks" placeholder="colis" oninput="liveEstimate('Sticks')">
            <label>Cadence manuelle (colis/h)</label><input type="number" id="cadenceManuelle-Sticks" placeholder="optionnel">
            <div class="stats">
              <p>Cadence calculÃ©e : <b id="cad-Sticks">0</b> c/h</p>
              <p>Fin estimÃ©e : <b id="finEst-Sticks">â€”</b></p>
            </div>
            <div class="row">
              <button type="submit">ğŸ’¾ Enregistrer</button>
              <button type="button" onclick="resetLine('Sticks')">ğŸ”„ Remise Ã  zÃ©ro</button>
            </div>
          </form>
          <div class="card"><h4>Historique</h4><div id="hist-Sticks"></div></div>
          <canvas id="graph-Sticks" height="120"></canvas>
        </section>

        <!-- === Emballage === -->
        <section id="line-Emballage" class="line-card hidden">
          <h3>Emballage</h3>
          <form onsubmit="saveProd(event,'Emballage')">
            <label>Heure dÃ©but</label><input type="time" id="debut-Emballage" required>
            <label>Heure fin</label><input type="time" id="fin-Emballage" required>
            <label>QuantitÃ© rÃ©alisÃ©e</label><input type="number" id="qte-Emballage" placeholder="colis">
            <label>QuantitÃ© restante</label><input type="number" id="reste-Emballage" placeholder="colis" oninput="liveEstimate('Emballage')">
            <label>Cadence manuelle (colis/h)</label><input type="number" id="cadenceManuelle-Emballage" placeholder="optionnel">
            <div class="stats">
              <p>Cadence calculÃ©e : <b id="cad-Emballage">0</b> c/h</p>
              <p>Fin estimÃ©e : <b id="finEst-Emballage">â€”</b></p>
            </div>
            <div class="row">
              <button type="submit">ğŸ’¾ Enregistrer</button>
              <button type="button" onclick="resetLine('Emballage')">ğŸ”„ Remise Ã  zÃ©ro</button>
            </div>
          </form>
          <div class="card"><h4>Historique</h4><div id="hist-Emballage"></div></div>
          <canvas id="graph-Emballage" height="120"></canvas>
        </section>

        <!-- === DÃ©s === -->
        <section id="line-DÃ©s" class="line-card hidden">
          <h3>DÃ©s</h3>
          <form onsubmit="saveProd(event,'DÃ©s')">
            <label>Heure dÃ©but</label><input type="time" id="debut-DÃ©s" required>
            <label>Heure fin</label><input type="time" id="fin-DÃ©s" required>
            <label>QuantitÃ© rÃ©alisÃ©e</label><input type="number" id="qte-DÃ©s" placeholder="colis">
            <label>QuantitÃ© restante</label><input type="number" id="reste-DÃ©s" placeholder="colis" oninput="liveEstimate('DÃ©s')">
            <label>Cadence manuelle (colis/h)</label><input type="number" id="cadenceManuelle-DÃ©s" placeholder="optionnel">
            <div class="stats">
              <p>Cadence calculÃ©e : <b id="cad-DÃ©s">0</b> c/h</p>
              <p>Fin estimÃ©e : <b id="finEst-DÃ©s">â€”</b></p>
            </div>
            <div class="row">
              <button type="submit">ğŸ’¾ Enregistrer</button>
              <button type="button" onclick="resetLine('DÃ©s')">ğŸ”„ Remise Ã  zÃ©ro</button>
            </div>
          </form>
          <div class="card"><h4>Historique</h4><div id="hist-DÃ©s"></div></div>
          <canvas id="graph-DÃ©s" height="120"></canvas>
        </section>

        <!-- === Filets === -->
        <section id="line-Filets" class="line-card hidden">
          <h3>Filets</h3>
          <form onsubmit="saveProd(event,'Filets')">
            <label>Heure dÃ©but</label><input type="time" id="debut-Filets" required>
            <label>Heure fin</label><input type="time" id="fin-Filets" required>
            <label>QuantitÃ© rÃ©alisÃ©e</label><input type="number" id="qte-Filets" placeholder="colis">
            <label>QuantitÃ© restante</label><input type="number" id="reste-Filets" placeholder="colis" oninput="liveEstimate('Filets')">
            <label>Cadence manuelle (colis/h)</label><input type="number" id="cadenceManuelle-Filets" placeholder="optionnel">
            <div class="stats">
              <p>Cadence calculÃ©e : <b id="cad-Filets">0</b> c/h</p>
              <p>Fin estimÃ©e : <b id="finEst-Filets">â€”</b></p>
            </div>
            <div class="row">
              <button type="submit">ğŸ’¾ Enregistrer</button>
              <button type="button" onclick="resetLine('Filets')">ğŸ”„ Remise Ã  zÃ©ro</button>
            </div>
          </form>
          <div class="card"><h4>Historique</h4><div id="hist-Filets"></div></div>
          <canvas id="graph-Filets" height="120"></canvas>
        </section>

        <!-- === PrÃ©dÃ©coupÃ© === -->
        <section id="line-PrÃ©dÃ©coupÃ©" class="line-card hidden">
          <h3>PrÃ©dÃ©coupÃ©</h3>
          <form onsubmit="saveProd(event,'PrÃ©dÃ©coupÃ©')">
            <label>Heure dÃ©but</label><input type="time" id="debut-PrÃ©dÃ©coupÃ©" required>
            <label>Heure fin</label><input type="time" id="fin-PrÃ©dÃ©coupÃ©" required>
            <label>QuantitÃ© rÃ©alisÃ©e</label><input type="number" id="qte-PrÃ©dÃ©coupÃ©" placeholder="colis">
            <label>QuantitÃ© restante</label><input type="number" id="reste-PrÃ©dÃ©coupÃ©" placeholder="colis" oninput="liveEstimate('PrÃ©dÃ©coupÃ©')">
            <label>Cadence manuelle (colis/h)</label><input type="number" id="cadenceManuelle-PrÃ©dÃ©coupÃ©" placeholder="optionnel">
            <div class="stats">
              <p>Cadence calculÃ©e : <b id="cad-PrÃ©dÃ©coupÃ©">0</b> c/h</p>
              <p>Fin estimÃ©e : <b id="finEst-PrÃ©dÃ©coupÃ©">â€”</b></p>
            </div>
            <div class="row">
              <button type="submit">ğŸ’¾ Enregistrer</button>
              <button type="button" onclick="resetLine('PrÃ©dÃ©coupÃ©')">ğŸ”„ Remise Ã  zÃ©ro</button>
            </div>
          </form>
          <div class="card"><h4>Historique</h4><div id="hist-PrÃ©dÃ©coupÃ©"></div></div>
          <canvas id="graph-PrÃ©dÃ©coupÃ©" height="120"></canvas>
        </section>

      </div>
    </section>

    <!-- ===== ARRETS ===== -->
    <section id="arrets" class="page-section">
      <h2>ArrÃªts</h2>
      <form id="formArret" onsubmit="saveArret(event)">
        <label>Ligne</label>
        <select id="arretLigne" required>
          <option>RÃ¢pÃ©</option><option>T2</option><option>RT</option><option>OMORI</option>
          <option>T1</option><option>Sticks</option><option>Emballage</option>
          <option>DÃ©s</option><option>Filets</option><option>PrÃ©dÃ©coupÃ©</option>
        </select>
        <label>DurÃ©e (min)</label><input type="number" id="arretDuree" required>
        <label>Cause</label><textarea id="arretCause" required></textarea>
        <button type="submit">ğŸ’¾ Enregistrer</button>
      </form>
      <div class="card">
        <h3>Historique des arrÃªts</h3>
        <div id="histArrets"></div>
      </div>
    </section>

    <!-- ===== ORGANISATION ===== -->
    <section id="organisation" class="page-section">
      <h2>Organisation</h2>
      <form id="formOrg" onsubmit="saveOrg(event)">
        <label>Ligne concernÃ©e</label>
        <select id="orgLigne">
          <option>Atelier</option>
          <option>RÃ¢pÃ©</option><option>T2</option><option>RT</option><option>OMORI</option>
          <option>T1</option><option>Sticks</option><option>Emballage</option>
          <option>DÃ©s</option><option>Filets</option><option>PrÃ©dÃ©coupÃ©</option>
        </select>
        <label>Consigne</label><textarea id="orgTexte" required></textarea>
        <button type="submit">ğŸ’¾ Enregistrer</button>
      </form>
      <div class="card"><h3>Historique</h3><div id="histOrg"></div></div>
    </section>

    <!-- ===== PERSONNEL ===== -->
    <section id="personnel" class="page-section">
      <h2>Personnel</h2>
      <form id="formPers" onsubmit="savePers(event)">
        <label>Nom</label><input id="persNom" required>
        <label>Motif</label>
        <select id="persMotif">
          <option>Absence</option><option>Retard</option><option>DÃ©part</option><option>Autre</option>
        </select>
        <label>Commentaire</label><textarea id="persCom"></textarea>
        <button type="submit">ğŸ’¾ Enregistrer</button>
      </form>
      <div class="card"><h3>Historique</h3><div id="histPers"></div></div>
    </section>
  </main>

  <!-- Calculatrice flottante -->
  <button id="openCalc" onclick="toggleCalc()">ğŸ§®</button>
  <div id="calculator" class="hidden">
    <input type="text" id="calcScreen" readonly />
    <div id="calcKeys"></div>
    <button class="closeCalc" onclick="toggleCalc()">Fermer</button>
  </div>

  <footer><p>SynthÃ¨se Atelier Lactalis Â© 2025</p></footer>
  <script src="app.js"></script>
</body>
</html>
